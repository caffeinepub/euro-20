{
  "kind": "build_request",
  "title": "Fix deployment/build failure",
  "priority": "high",
  "requirements": [
    {
      "id": "REQ-1",
      "text": "Identify the exact build/deploy failure causing the deployment error and fix the root cause so the project builds and deploys successfully on the Internet Computer.",
      "target": "both",
      "source": {
        "messageIds": [
          "recent-messages"
        ],
        "quotes": [
          "üôè Deployment encountered an error",
          "can you fix the error"
        ]
      },
      "acceptanceCriteria": [
        "A clean build completes without errors.",
        "A deploy completes successfully (no deployment error).",
        "The underlying root cause is fixed (not just suppressed), and the fix is committed in code/config."
      ]
    },
    {
      "id": "REQ-2",
      "text": "Eliminate any frontend build/runtime crash caused by referencing Node-style environment variables (e.g., `process.env.*`) in the browser bundle (notably `process.env.II_URL` used by the Internet Identity hook) without editing immutable files; implement a safe shim or build configuration so the app runs in the browser and Internet Identity login continues to function.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "recent-messages"
        ],
        "quotes": [
          "üôè Deployment encountered an error"
        ]
      },
      "acceptanceCriteria": [
        "The frontend bundle does not throw `process is not defined` (or equivalent) at build time or at runtime.",
        "Internet Identity login flow still works and uses a valid identity provider URL.",
        "No files under `frontend/src/hooks/useInternetIdentity.ts` (immutable) are modified."
      ]
    },
    {
      "id": "REQ-3",
      "text": "Add a minimal, user-facing error surface for failed authentication/actor initialization and failed streak mutations so errors that would otherwise appear only in console logs are visible in the UI in English.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "recent-messages"
        ],
        "quotes": [
          "can you fix the error"
        ]
      },
      "acceptanceCriteria": [
        "When Internet Identity initialization/login fails, the UI displays a clear English error message (no blank/unclear state).",
        "When actor creation or streak mutations fail, the UI displays a clear English error message and the app remains usable.",
        "Errors are not only logged to the console; the user can see them in-app."
      ]
    }
  ],
  "constraints": [
    "Backend must remain a single-actor Motoko canister; keep all logic in `backend/main.mo`.",
    "Only create `backend/migration.mo` if state schema changes require it (conditional migration policy).",
    "Do not edit immutable frontend paths: `frontend/src/hooks/useInternetIdentity.ts`, `frontend/src/hooks/useInternetIdentity.tsx`, `frontend/src/hooks/useActor.ts`, `frontend/src/main.tsx`, `frontend/src/components/ui`.",
    "Use English for any user-facing text."
  ],
  "nonGoals": [
    "Adding new product features unrelated to fixing the deployment/build error.",
    "Changing authentication provider away from Internet Identity.",
    "Introducing external databases, third-party auth providers, or non-supported backend technologies."
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  }
}